import { Map, MapObjectType } from "./MapTypes";

function createMap(): Map {
  return {
    name: "Glimmer",
    width: 1920,
    height: 1080,
    layers: [
      {
        name: "Level",
        visible: true,
        objects: [
          {
            type: MapObjectType.IMAGE,
            positions: [[0, 0]],
            src: "https://i.imgur.com/3d1GbEM.png",
            width: 1920,
            height: 1080,
          },
        ],
      },
      {
        name: "Red Gems",
        visible: true,
        objects: [
          {
            type: MapObjectType.IMAGE,
            positions: [
              [421.83893666927287, 910.078125],
              [435.3494917904613, 926.578125],
              [447.3588741204066, 947.578125],
              [456.3659108678655, 965.578125],
              [481.88584831899925, 1010.578125],
              [499.8999218139171, 1010.578125],
              [547.9374511336982, 898.078125],
              [597.4761532447225, 859.078125],
              [394.81782642689603, 832.078125],
              [496.89757623143083, 670.078125],
              [490.8928850664582, 617.578125],
              [550.9397967161846, 602.578125],
              [565.9515246286161, 667.078125],
              [564.450351837373, 517.078125],
              [592.9726348709929, 517.078125],
              [529.9233776387803, 539.578125],
              [513.4104769351055, 545.578125],
              [471.3776387802971, 584.578125],
              [465.3729476153245, 589.078125],
              [315.2556684910086, 679.078125],
              [345.2791243158718, 694.078125],
              [345.2791243158718, 706.078125],
              [288.23455824863174, 734.578125],
              [321.26035965598123, 500.578125],
              [343.77795152462863, 494.578125],
              [358.7896794370602, 476.578125],
              [435.3494917904613, 433.078125],
              [442.8553557466771, 433.078125],
              [537.4292415949961, 395.578125],
              [537.4292415949961, 331.078125],
              [559.9468334636434, 278.578125],
              [570.4550430023456, 259.078125],
              [636.5066458170446, 287.578125],
              [657.5230648944488, 299.578125],
              [986.2799061767006, 277.078125],
              [1010.2986708365911, 190.078125],
              [1016.3033620015638, 218.578125],
              [1040.3221266614544, 178.078125],
              [1052.3315089913995, 208.078125],
              [950.2517591868648, 139.078125],
              [963.7623143080532, 92.578125],
              [923.2306489444879, 92.578125],
              [867.687255668491, 94.078125],
              [876.6942924159499, 119.578125],
              [876.6942924159499, 158.578125],
              [1266.9992181391713, 461.578125],
              [1285.0132916340892, 457.078125],
              [1227.9687255668491, 413.578125],
              [1300.0250195465208, 407.578125],
              [1304.5285379202503, 422.578125],
              [1322.542611415168, 344.578125],
              [1354.0672400312744, 361.078125],
              [1352.5660672400313, 392.578125],
              [1339.055512118843, 463.078125],
              [1327.0461297888976, 481.078125],
              [1297.0226739640343, 499.078125],
              [1257.9921813917124, 509.578125],
              [1227.9687255668491, 508.078125],
              [1121.3854573885849, 532.078125],
              [1303.027365129007, 848.578125],
            ],
            src:
              "https://cdn.discordapp.com/attachments/725559815014711356/807736641434812446/Red_Gem.png",
            width: 24,
            height: 24,
          },
        ],
      },
    ],
  };
}

function addGem(map: Map, x: number, y: number): Map {
  map.layers[1].objects = [
    {
      ...map.layers[1].objects[0],
      positions: [...map.layers[1].objects[0].positions, [x - 12, y - 12]],
    },
  ];

  return { ...map };
}

function toggleLayer(map: Map, layerName: string) {
  const layers = [...map.layers];
  const layerIndex = layers.findIndex((layer) => layer.name === layerName);

  if (layerIndex < 0) return map;

  layers[layerIndex].visible = !layers[layerIndex].visible;

  return {
    ...map,
    layers,
  };
}

export default {
  createMap,
  addGem,
  toggleLayer,
};
